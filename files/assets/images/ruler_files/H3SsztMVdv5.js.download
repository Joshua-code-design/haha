;/*FB_PKG_DELIM*/

__d("CometOnOutsideClick.react",["react","react-compiler-runtime","useOnOutsideClick"],(function(a,b,c,d,e,f,g){"use strict";var h;h||d("react");function a(a){var b=d("react-compiler-runtime").c(3),e=a.children;a=a.onOutsideClick;a=c("useOnOutsideClick")(a);var f;b[0]!==e||b[1]!==a?(f=e(a),b[0]=e,b[1]=a,b[2]=f):f=b[2];return f}g["default"]=a}),98);
__d("LSUpdateThreadParticipantNickname",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(14).fetch([[[a[0],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.contactId,a[1])}),function(c){var d=c.update;c.item;return d({authorityLevel:b.i64.cast([0,20]),nickname:a[2]===""?void 0:a[2],normalizedSearchTerms:a[3]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateThreadParticipantNicknameStoredProcedure";a.__tables__=["participants"];e.exports=a}),null);
__d("LSOptimisticUpdateThreadParticipantNickname",["LSIssueNewError","LSIssueNewTask","LSLocalize","LSUpdateThreadParticipantNickname"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=(a[2]==null?"":a[2]).trim(),d[1]=d[0]===""?void 0:d[0],c.storedProcedure(b("LSUpdateThreadParticipantNickname"),a[0],a[1],d[1],d[1])},function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[2]=c.i64.cast([0,1]):(b=a.item,d[9]=b.syncGroup,c.i64.neq(d[9],void 0)?d[8]=d[9]:d[8]=c.i64.cast([0,1]),d[2]=d[8])})},function(a){return c.sortBy(c.db.table(115).fetch(),[["timestampMs","DESC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[4]=!1:(b=a.item,d[4]=b.errorShouldBeShown)})},function(a){return d[4]===!0?c.sequence([function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,2285622730]),void 0).then(function(a){return d[8]=a})},function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,1919524925]),void 0).then(function(a){return d[9]=a})},function(a){return c.storedProcedure(b("LSIssueNewError"),void 0,c.i64.cast([0,1545093]),d[8],d[9],void 0,void 0)}]):c.resolve()},function(e){return d[6]=new c.Map(),d[6].set("thread_key",a[0]),d[6].set("contact_id",a[1]),d[6].set("nickname",d[1]),d[6].set("sync_group",d[2]),d[7]=c.toJSON(d[6]),c.storedProcedure(b("LSIssueNewTask"),"thread_participant_nickname",c.i64.cast([0,44]),d[7],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticUpdateThreadParticipantNicknameStoredProcedure";a.__tables__=["threads","user_visible_network_connectivity_error"];e.exports=a}),null);
__d("LSOptimisticUpdateThreadParticipantNicknameStoredProcedure",["LSOptimisticUpdateThreadParticipantNickname","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticUpdateThreadParticipantNickname"),e.threadKey,e.contactId,e.nickname);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MWXIconPencilUnderline",["MWXSvgIcon","SVGIcon","cr:12517","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgIcon(d("SVGIcon").svgIcon(b("cr:12517")),c("gkx")("23219"));g["default"]=a}),98);
__d("LSNicknameDialog.react",["fbt","Box.react","CometHideLayerOnEscape.react","CometOnOutsideClick.react","CometScrollableArea.react","CometTextInput_DEPRECATED.react","CometTextWithEntities.react","I64","Int64Hooks","LSFactory","LSOptimisticUpdateThreadParticipantNicknameStoredProcedure","MDSListCellPressable.react","MWChatTextTransform","MWXCardedDialog.react","MWXCircleButton.react","MWXIconCheckmark","MWXIconPencilUnderline","MWXProfilePhoto.react","MWXTextPairing.react","QuickPerformanceLogger","ReQL","ReQLSuspense","XPlatReactEnvironment","getLSMediaContactProfilePictureUrl","promiseDone","qpl","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=l||(l=d("react"));b=l;b.useCallback;var n=b.useEffect,o=b.useLayoutEffect,p=b.useState;function q(a){var b=a.contact,e=a.onSelect;a=a.participant;var f=a.nickname;f=m.jsx(c("CometTextWithEntities.react"),{text:f!=null?f:b.name,transforms:[d("MWChatTextTransform").emojiTransform]});a=a.nickname;a=a!=null?b.name:h._(/*BTDS*/"Set nickname");return m.jsx(c("MDSListCellPressable.react"),{addOnEnd:m.jsx(c("MWXCircleButton.react"),{icon:c("MWXIconPencilUnderline"),label:h._(/*BTDS*/"Edit nickname"),onPress:function(){return e()},size:36,type:"deemphasized"}),addOnStart:m.jsx(c("MWXProfilePhoto.react"),{shape:"circle",size:40,source:{uri:c("getLSMediaContactProfilePictureUrl")(b)}}),content:m.jsx(c("MWXTextPairing.react"),{body:a,headline:f,level:4}),onPress:function(){return e()},size:"medium",testid:void 0,xstyle:r.cell})}q.displayName=q.name+" [from "+f.id+"]";var r={cell:{flexShrink:"x2lah0s",minHeight:"x1rfaoo0",$$css:!0},input:{marginTop:"x16ldp7u",$$css:!0}};function s(a){var b=d("react-compiler-runtime").c(41),e=a.contact,g=a.onDeselect,l=a.participant,n=a.thread,o=(i||(i=c("useReStore")))(),q;b[0]!==e.id||b[1]!==o||b[2]!==n.threadKey?(a=function(a){c("promiseDone")(o.runInTransaction(function(b){return c("LSOptimisticUpdateThreadParticipantNicknameStoredProcedure")(c("LSFactory")(b),{contactId:e.id,nickname:a,threadKey:n.threadKey})},"readwrite",void 0,void 0,f.id+":151"))},q=[o,n.threadKey,e.id],b[0]=e.id,b[1]=o,b[2]=n.threadKey,b[3]=a,b[4]=q):(a=b[3],q=b[4]);var s=d("Int64Hooks").useCallbackInt64(a,q);b[5]!==l.nickname?(a=function(){var a=l.nickname;if(a!=null)return a;else return""},b[5]=l.nickname,b[6]=a):a=b[6];q=p(a);var t=q[0],u=q[1];b[7]!==l.contactId?(a=function(a){(k||(k=c("QuickPerformanceLogger"))).markerPoint(c("qpl")._(269236510,"1886"),"input_changed",{instanceKey:(j||(j=d("I64"))).to_int32(l.contactId)}),u(a)},b[7]=l.contactId,b[8]=a):a=b[8];var v=a;b[9]!==t||b[10]!==g||b[11]!==l.contactId||b[12]!==s?(q=function(){(k||(k=c("QuickPerformanceLogger"))).markerPoint(c("qpl")._(269236510,"1886"),"submit",{instanceKey:(j||(j=d("I64"))).to_int32(l.contactId)});s(t);return g(!0)},b[9]=t,b[10]=g,b[11]=l.contactId,b[12]=s,b[13]=q):q=b[13];var w=q;b[14]===Symbol["for"]("react.memo_cache_sentinel")?(a=h._(/*BTDS*/"Submit nickname"),b[14]=a):a=b[14];b[15]!==w?(q=m.jsx(c("MWXCircleButton.react"),{icon:c("MWXIconCheckmark"),label:a,onPress:w,onPressIn:w,size:36,testid:void 0,type:"deemphasized"}),b[15]=w,b[16]=q):q=b[16];b[17]!==e?(a=c("getLSMediaContactProfilePictureUrl")(e),b[17]=e,b[18]=a):a=b[18];var x;b[19]!==a?(x=m.jsx(c("MWXProfilePhoto.react"),{shape:"circle",size:40,source:{uri:a}}),b[19]=a,b[20]=x):x=b[20];b[21]!==g?(a=function(){return g(!1)},b[21]=g,b[22]=a):a=b[22];var y;b[23]!==g?(y=function(){return g(!1)},b[23]=g,b[24]=y):y=b[24];var z;b[25]!==e.name||b[26]!==t||b[27]!==w||b[28]!==l.nickname||b[29]!==v?(z=function(a){var b=l.nickname;return m.jsx(c("CometTextInput_DEPRECATED.react"),{autoFocus_PLEASE_USE_FOCUS_REGION_INSTEAD:!0,label:h._(/*BTDS*/"Nickname text input"),labelIsHidden:!0,onChangeText:function(a){return v(a)},onSubmitEditing:w,placeholder:b!=null?b:e.name,ref:a,spellCheck:!1,testid:void 0,value:t})},b[25]=e.name,b[26]=t,b[27]=w,b[28]=l.nickname,b[29]=v,b[30]=z):z=b[30];var A;b[31]!==y||b[32]!==z?(A=m.jsx(c("CometOnOutsideClick.react"),{onOutsideClick:y,children:z}),b[31]=y,b[32]=z,b[33]=A):A=b[33];b[34]!==A||b[35]!==a?(y=m.jsx(c("Box.react"),{xstyle:r.input,children:m.jsx(c("CometHideLayerOnEscape.react"),{onHide:a,children:A})}),b[34]=A,b[35]=a,b[36]=y):y=b[36];b[37]!==y||b[38]!==q||b[39]!==x?(z=m.jsx(c("MDSListCellPressable.react"),{addOnEnd:q,addOnStart:x,content:y,size:"medium",xstyle:r.cell}),b[37]=y,b[38]=q,b[39]=x,b[40]=z):z=b[40];return z}var t={scrollContainerDesktop:{maxHeight:"x1rq5m6k",$$css:!0},scrollContainerWeb:{maxHeight:"x1evr0zj",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(26),e=a.onClose,g=a.renderingTracker,l=a.thread,r=(i||(i=c("useReStore")))();b[0]!==r.tables.contacts||b[1]!==r.tables.participants||b[2]!==l.threadKey?(a=function(){return d("ReQL").fromTableAscending(r.tables.participants).getKeyRange(l.threadKey).map(function(a){var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(r.tables.contacts).getKeyRange(a.contactId),f.id+":274");return[a,b]})},b[0]=r.tables.contacts,b[1]=r.tables.participants,b[2]=l.threadKey,b[3]=a):a=b[3];var v;b[4]!==r||b[5]!==l.threadKey?(v=[r,l.threadKey],b[4]=r,b[5]=l.threadKey,b[6]=v):v=b[6];a=d("ReQLSuspense").useArray(a,v,f.id+":269");(k||(k=c("QuickPerformanceLogger"))).markerPoint(c("qpl")._(269230744,"1734"),"data_loaded");v=a.slice(0).sort(x);a=p();var y=a[0],z=a[1];b[7]!==y?(a=function(a,b){y!=null&&(k||(k=c("QuickPerformanceLogger"))).markerEnd(c("qpl")._(269236510,"1886"),b?2:4,(j||(j=d("I64"))).to_int32(y)),z(a),a!=null&&((k||(k=c("QuickPerformanceLogger"))).markerStart(c("qpl")._(269236510,"1886"),(j||(j=d("I64"))).to_int32(a)),k.markerAnnotate(c("qpl")._(269236510,"1886"),{string:{xplat_react_enabled:"true"}},{instanceKey:j.to_int32(a)}))},b[7]=y,b[8]=a):a=b[8];var A=a;b[9]===Symbol["for"]("react.memo_cache_sentinel")?(a=h._(/*BTDS*/"Nicknames"),b[9]=a):a=b[9];a=a;var B;b[10]===Symbol["for"]("react.memo_cache_sentinel")?(B=[],b[10]=B):B=b[10];o(w,B);b[11]===Symbol["for"]("react.memo_cache_sentinel")?(B=[],b[11]=B):B=b[11];n(u,B);B=c("MWXCardedDialog.react");var C="nickname_dialog_close_button",D=!0,E=c("CometScrollableArea.react"),F=!0,G=!1,H=d("XPlatReactEnvironment").isWeb()?t.scrollContainerWeb:t.scrollContainerDesktop,I;b[12]!==y||b[13]!==A||b[14]!==l?(I=function(a){var b=a[1];if(b==null)return null;var c=a[0];a=y!=null?(j||(j=d("I64"))).equal(y,c.contactId):!1;if(a)return m.jsx(s,{contact:b,onDeselect:function(a){return A(void 0,a)},participant:c,thread:l},(j||(j=d("I64"))).to_string(c.contactId));else return m.jsx(q,{contact:b,onSelect:function(){return A(c.contactId,!1)},participant:c},(j||(j=d("I64"))).to_string(c.contactId))},b[12]=y,b[13]=A,b[14]=l,b[15]=I):I=b[15];v=v.map(I);b[16]!==E||b[17]!==g||b[18]!==H||b[19]!==v?(I=m.jsxs(E,{expanding:F,horizontal:G,xstyle:H,children:[v,g]}),b[16]=E,b[17]=g,b[18]=H,b[19]=v,b[20]=I):I=b[20];b[21]!==B||b[22]!==e||b[23]!==I||b[24]!==a?(F=m.jsx(B,{closeButtonTestId:C,onClose:e,title:a,withCloseButton:D,children:I}),b[21]=B,b[22]=e,b[23]=I,b[24]=a,b[25]=F):F=b[25];return F}function u(){(k||(k=c("QuickPerformanceLogger"))).markerPoint(c("qpl")._(269230744,"1734"),"on_mount");return v}function v(){(k||(k=c("QuickPerformanceLogger"))).markerEnd(c("qpl")._(269230744,"1734"),4),k.markerStart(c("qpl")._(269227718,"1887")),k.markerAnnotate(c("qpl")._(269227718,"1887"),{string:{xplat_react_enabled:"true"}},{}),k.markerEnd(c("qpl")._(269227718,"1887"),2)}function w(){(k||(k=c("QuickPerformanceLogger"))).markerPoint(c("qpl")._(269230744,"1734"),"before_mount")}function x(a,b){b=b[1];a=a[1];if(a!=null)if(b!=null)return b.rank-a.rank;else return 0;else return 0}g["default"]=a}),226);
__d("MessengerPencilUnderlineFilled.svg.react",["XPlatReactSVG","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(d("XPlatReactSVG").Svg,babelHelpers["extends"]({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:a.title},a,{children:[a.children!=null&&i.jsx(d("XPlatReactSVG").Defs,{children:a.children}),i.jsx(d("XPlatReactSVG").Path,{d:"M24.903 13.63a.75.75 0 0 1-1.06 0l-2.476-2.475a.75.75 0 0 1 0-1.06l1.362-1.363a2.5 2.5 0 0 1 3.536 3.536l-1.362 1.362zM18.892 12.569a.75.75 0 0 1 1.061 0l2.475 2.475a.75.75 0 0 1 0 1.06l-8.938 8.938a4.004 4.004 0 0 1-.972.715l-4.05 2.121c-.868.455-1.804-.482-1.35-1.35l2.122-4.05c.188-.358.429-.685.715-.972l8.937-8.937zM18 25.5a1 1 0 0 0-1 1v.5a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-.5a1 1 0 0 0-1-1H18z"})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);